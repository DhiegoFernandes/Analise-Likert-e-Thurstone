---
title: "**Análise Comparativa de Escalas de Atitude (Likert vs. Thurstone) com R**: 'Opinião dos estudantes sobre a importância do conhecimento teórico vs conhecimento prático no ensino superior'"
author: "Dhiego Fernandes da Silva | Moises Alves Silva | Guilherme Cunha Alves"
output:
  html_document:
    toc: true
    toc_depth: 2
    toc_float: true
    number_sections: true
  pdf_document:
    toc: true
    number_sections: true
lang: pt-BR
---

```{r setup, include=FALSE}
# Executa o script que calcula as estatísticas e gera os gráficos
source(here::here("R", "analisedados.R"))
```

## **INTRODUÇÃO**

  O debate sobre o equilíbrio entre conhecimento teórico e conhecimento prático no ensino superior é cada vez mais relevante diante das rápidas mudanças no mercado de trabalho e das exigências por profissionais com capacidades e entendimentos amplos. Enquanto a teoria fornece as bases conceituais necessárias para compreender fenômenos e desenvolver pensamento crítico, a prática oferece a vivência de situações reais, preparando os estudantes para os desafios profissionais imediatos.

  Neste contexto, essa pesquisa procura compreender a **“Opinião dos estudantes sobre a importância do conhecimento teórico vs. conhecimento prático no ensino superior”** e a relação entre esses dois tipos de conhecimento em sua formação acadêmica. Fazendo assim comparações com as metodologias de mensuração de atitudes, **Escala de Likert e a Escala de Thurstone**.

  A relevância deste estudo reside em fornecer evidências sobre a percepção dos estudantes, como a importância do conhecimento teórico em relação ao conhecimento prático é percebido por eles na formação universitária, permitindo refletir sobre como universidades podem alinhar seus currículos às demandas, considerando entre fundamentos teóricos e experiências práticas.

## **METODOLOGIA**

### Público-alvo e amostragem

O público-alvo da pesquisa compreende estudantes que estão cursando ou já concluíram uma graduação ou pós-graduação. A amostragem foi não probabilística por conveniência, realizada por meio da divulgação de um formulário online do Google Forms em redes sociais e grupos acadêmicos. A participação foi voluntária, com a possibilidade de responder anonimamente sem a necessidade de informar nome ou gênero.

### Tamanho da amostra:

No total, foram obtidos **48** respostas. Dentre elas, foram selecionados apenas os participantes com experiência atual ou prévia no ensino superior. Foram excluídos aqueles que trancaram ou abandonaram o curso, bem como os que nunca cursaram o ensino superior. Dessa forma, **46** respostas foram utilizadas na análise.

### Instrumento de coleta de dados

O questionário foi dividido em duas partes:

(1) Dados sociodemográficos: nome (opcional), idade, gênero (opcional) e situação atual em relação ao ensino superior.

(2) Itens de atitude:
    * Foram elaboradas cinco afirmações, que compõem o mesmo conjunto de itens avaliados nas duas escalas diferentes:
        (1) A universidade se distancia da realidade do mercado de trabalho ao focar demais em teoria.
        (2) As disciplinas devem focar mais em projetos práticos do que em aulas teóricas.
        (3) É responsabilidade da universidade garantir que os alunos saiam preparados para o mercado de trabalho.
        (4) Uma formação sólida em teoria permite que um profissional se adapte a qualquer desafio futuro.
        (5) Teorias e conceitos fundamentais são mais importantes do que habilidades práticas.
        
    * **Escala de Likert**: Foram criadas cinco afirmações avaliadas em uma escala de 5 pontos (1 = Discordo totalmente a 5 = Concordo totalmente).

    * **Escala de Thurstone**: as mesmas cinco afirmativas foram reapresentadas em formato dicotômico (**Concordo / Discordo**), sendo atribuídos pesos previamente definidos a cada item com base em julgamentos dos autores da pesquisa.



### Procedimentos de análise

Os dados foram importados e tratados no RStudio, utilizando pacotes como **readr**, **dplyr**, **ggplot2** e **psych**.
Para a **Escala de Likert**, as respostas foram codificadas numericamente (1 a 5), e para melhor resultado, foram invertidas as questões 4 e 5 que são pró-teoria para que escores mais altos indicassem maior valorização da prática, ou seja, questões que se aliam com a teoria tem a pontuação invertida para que todas as questões sigam uma mesma direção.
Para a **Escala de Thurstone**, as respostas **Concordo** receberam valor 1 e **Discordo**, 0. Cada item possui um peso previamente estabelecido, e o escore final de cada participante corresponde à média dos pesos das afirmativas com concordância.
Sendo assim, foi calculado um escore total de ambas escalas para cada participante, esse escore total indica em formato numérico se o participante está mais alinhado com a teoria ou a pratica.

As análises estatísticas incluíram medidas de média, mediana, dispersão, como o desvio padrão e Amplitude Interquartil (IQR) e histogramas e boxplots em relação aos escores das duas escalas.

### Interpretação dos escores

#### Escala Likert
Pontuação de 1 a 5 por item, (As perguntas 4 e 5 foram invertidos como citadas anteriormente para consistência).  

- **Menor escore (5):** indica valorização da teoria.  
- **Maior escore (25):** indica valorização da prática.

#### Escala Thurstone
Cada afirmação da Escala Thurstone possui um peso previamente definido, refletindo a importância relativa de cada item no continuum atitudinal. No nosso estudo, os pesos foram: 2, 2, 4, 10 e 10.

- **Menor escore (2):** concorda apenas com itens de menor peso → forte valorização da prática.  
- **Maior escore (10):** concorda apenas com itens de maior peso → forte valorização da teoria.  


#### Diferenças (Resumo)
- **Likert:** todos os itens têm mesmo peso, ocorre a soma simples das respostas; 
- **Thurstone:** itens têm pesos diferentes, o escore é a média dos pesos.

## **RESULTADOS**

Esta seção apresenta os resultados obtidos a partir da aplicação das Escalas de Likert e Thurstone, evidenciando a opinião dos participantes sobre a importância do conhecimento teórico versus prático no ensino superior.

### **Estatísticas descritivas**



**Estatísticas principais da escala Likert:**
```{r tabela-likert-thurstone, echo=FALSE}
library(knitr)
kable(likert_stats, caption = "Tabela 1 – Estatísticas descritivas da Escala de Likert")
```



**Estatísticas principais da escala Thurstone:**
```{r tabela-thurstone, echo=FALSE}
library(knitr)
kable(thurstone_stats, caption = "Tabela 2 – Estatísticas descritivas da Escala de Thurstone")
```



### **Distribuição dos escores**

Os gráficos a seguir ilustram a distribuição dos escores obtidos em cada escala.

```{r grafico-likert, echo=FALSE, fig.cap="Figura 1 – Distribuição dos escores na Escala de Likert."}
knitr::include_graphics(here("plots", "distribuicao_likert.png"))
```

No gráfico de histograma da escala likert, o eixo horizontal representa o escore total, que varia de 5 a 25, as pontuações mais altas próximas a 25 indicam uma maior **valorização do conhecimento prático**, enquanto pontuações mais baixas (próximas de 5) indicam uma maior valorização do conhecimento teórico. Pode se ter o entendimento que a concentração maior se está entre 15 e 24, e há uma **assimetria negativa**. Esses resultados sugerem que os alunos tem opiniões amplamente alinhadas, reforçando a ideia de que o conhecimento prático é considerado mais relevante que a teoria na formação no ensino superior




```{r grafico-thurstone, echo=FALSE, fig.cap="Figura 2 – Distribuição dos escores na Escala de Thurstone."}
knitr::include_graphics("plots/distribuicao_thurstone.png")
```

O histograma da Distribuição de Escores da escala Thurstone revela que a maoria dos participantes tende a **valorizar o conhecimento prático**, visto que valores baixos indicam maior valorização da prática e valores altos indicam maior valorização da teoria, a pontuação dos participantes varia de 2 a 10 no eixo horizontal, e é possível ver uma barra isolada em 10, onde que mostra que pelo menos um participante concordou com mais com a teoria, a distribuição é assimétrica a direita. A distribuição tem uma **assimetria positiva**, com uma dispersão ampla, demonstrando maior variabilidade que a escala Likert.


### Boxplots

Os boxplots a seguir evidenciam a dispersão dos dados em cada escala.

```{r boxplot-likert, echo=FALSE, fig.cap="Figura 3 – Boxplot da Escala de Likert."}
knitr::include_graphics("plots/box_likert.png")
```

Verifica-se no gráfico bloxplot da escala de likert uma forte **valorização do conhecimento prático**, o gráfico mostra que a maioria dos alunos tem opinião alinhada, com mediana próxima de **19** e cerca de metade das respostas estão concentradas entre 17 e 20, mostrando baixa dispersão e grande consenso entre os participantes. Os bigodes variam de cerca de 12 a 24 mostrando a dispersão das opiniões, enquanto um outlier próximo de 10 revela a presença de um participante que valoriza mais o conhecimento teórico.

```{r boxplot-thurstone, echo=FALSE, fig.cap="Figura 4 – Boxplot da Escala de Thurstone."}
knitr::include_graphics("plots/box_thurstone.png")
```

Verifica-se no boxplot da escala de Thurstone que os **alunos preferem a prática**, visto que nessa escala os valores mais baixos representam a valorização da prática, a mediana se encontra em aproximadamente **3.75**. A caixa, que representa 50% das respostas, se estende de cerca de 2.75 a 4.75, a distribuição mostra uma variabilidade maior do que a da Escala de Likert, o que pode ser evidenciado pela presença de dois **outliers** em 8 e 10, de alunos com pensamentos diferentes da maioria, que preferem a teoria.

## **DISCUSSÃO E ANÁLISE COMPARATIVA**


### Relação entre os escores

Aqui vamos investigar a relação entre os escores obtidos nas escalas de Likert e de Thurstone para a atitude dos estudantes sobre a importância do conhecimento prático versus teórico. Embora as duas escalas utilizem procedimentos de construção distintos, ambas medem o mesmo conceito e, portanto, espera-se consistência nos resultados. É importante observar o sentido das pontuações: na escala de Likert, valores mais altos indicam maior valorização da prática, enquanto na escala de Thurstone valores mais baixos representam essa mesma preferência. A Figura 6 apresenta os histogramas lado a lado, permitindo a comparação visual de posição, dispersão e possíveis outliers, que discutimos a seguir.

```{r boxplot-correlacao, echo=FALSE, fig.cap="Figura 6 – Histograma de distribuição de Escores Likert vs. Thurstone."}
knitr::include_graphics("plots/histogramas_facetados.png")
```

Ao observar os histogramas das duas escalas, Likert e Thurstone, lado a lado, é possível notar semelhanças e diferenças importantes:

  * **Resultados Similares**: Ambas as escalas, apesar de suas metodologias distintas, produziram resultados finais semelhantes. Em ambos os casos, a maior concentração de escores se localiza na faixa que indica a **valorização do conhecimento prático**. Isso sugere que as duas escalas foram eficazes em capturar a mesma tendência geral do público.
  * **Distribuições**: O histograma de Likert mostra uma distribuição mais concentrada e simétrica, com a maioria das respostas agrupadas. Já o histograma de Thurstone tem dois picos principais, que apresenta uma distribuição assimétrica positiva, que se estende para valores mais altos referentes a teoria.
  *	**Dispersão**: A distribuição de Likert é a menos dispersa, o que indica uma opinião mais consistente nessa escala. A distribuição de Thurstone, por sua vez é mais variável, com escores mais espalhados, mostrando uma diversidade maior de opiniões.


### Comparação entre escalas

A Figura 5 apresenta um boxplot comparativo dos escores obtidos nas duas escalas, permitindo visualizar possíveis diferenças de dispersão e mediana.

```{r boxplot-comparativo, echo=FALSE, fig.cap="Figura 5 – Comparação de escores entre as Escalas de Likert e Thurstone."}
knitr::include_graphics("plots/box_comparativo.png")
```


Em relação a comparações dos escores entre as escalas, verifica-se que, na escala de Likert, a mediana está próxima de **19**, com 50% dos escores concentrados entre cerca de 17 e 20; os bigodes vão aproximadamente de 12 a 24 e há um outlier por volta de 10, indicando baixa dispersão e **alto consenso**.

Na escala de Thurstone, a mediana fica em torno de **3,7**; a caixa vai de cerca de 2,7 a 4,7; os bigodes se estendem aproximadamente de 2 a 6/7 e há dois outliers em 8 e 10, evidenciando maior variabilidade.

Considerando o sentido das escalas (Likert: valores altos = prática; Thurstone: valores baixos = prática), ambos os boxplots apontam para preferência pela prática, embora a Thurstone apresente maior dispersão dos escores.

### **Interpretação dos Métodos e Limitações**

#### **Limitações**

Em geral as análises e resultados da escala Likert foram mais fáceis de produzir e analisar em relação a escala Thurstone, pois ela não exige um painel de juízes para ponderar os itens. A analise foi mais simples pois os alunos que responderam a pesquisa expressaram o seu próprio grau de concordância ou discordância em cada item.

A escala Thurstone, foi **mais complexa** de construir, pois o peso das perguntas deveriam ser indicados por um grupo de juízes para cada pergunta com base na média de cada valor dado pelos juízes. Embora, para o respondente, a resposta é mais fácil, pois ele escolhe apenas entre  discordo, ou concordo.

#### **Qual escala capturou melhor a atitude?**

Em relação a medição da atitude, a **Escala de Thurstone** pode ter sido a mais precisa, devido a natureza da escala que é a média dos pesos com o qual o participante concordou. Enquanto a escala Likert trata de todas as intensidades (Concordancia de 1 a 5), a escala Thurstone se diferencia pelo peso e importância de cada afirmação, demonstrando que algumas respostas podem ter maior peso que outras. Além disso, a maior dispersão da que foi encontrada nas análises da escala Thurstone pode ser um indicativo de que ela capturou melhor a variedade de nuances do que a Likert.

#### **Limitações de Estudo**

* **Tempo e financeiro**: O curto tempo para a realização da pesquisa, criação de análises e pouco compartilhamento devido a falta de promoção geram limitação a quantidade de análises e resultados finais.
* **Tamanho da amostra**: A amostra de 46 participantes é pequena e pode não ser suficiente para tirar conclusões definitivas sobre o tema
* **Amostra não-probabilística**: A amostragem por conveniência limita a confiança dos resultados. As opiniões dos estudantes que responderam a pesquisa podem não ser representativas de todos os estudantes no ensino superior, .
* **Viés de resposta**: A natureza online do questionário e o fato de ser voluntário pode ter atraído participantes com opiniões mais fortes sobre o tema, gerando um viés de resposta, além de não ter sido coletados dados de outras formas, como presencial.
* **Validade das escalas**: A construção da escala de Thurstone foi feita pelos próprios autores, e não por um painel de juízes especialistas, o que pode comprometer a validade e a confiabilidade dos pesos atribuídos.


## **CONCLUSÃO**

Este estudo comparou duas abordagens de mensuração, Likert e Thurstone, para avaliar a valorização do conhecimento prático em relação ao teórico entre estudantes do ensino superior. Os resultados seguem alinhados para a mesma conclusão final, onde há uma clara **preferência pela prática**. Na escala de Likert, os escores se concentram em níveis altos (mediana próxima de 19 e baixa dispersão), indicando forte consenso. Na escala de Thurstone, a mediana baixa (≈ 3,7) aponta para o mesmo padrão, porém com uma maior variabilidade e presença de mais outliers, revelando resultados que tende a valorizar mais a teoria. Os histogramas e boxplots criados evidenciam validade similar entre as medidas, mesmo que sejam escalas com métodos e sensibilidades diferentes, em que a Likert exibe o consenso geral dos estudantes, enquanto a escala Thurstone destaca melhor as respostas controversas. 

Do ponto de vista prático, os resultados da pesquisa sugerem que a prática é mais valorizada pelos alunos, mas **não substitui a teoria**, de acordo com outliers encontrados. A prática deve ser priorizada em relação a teoria, como atividades de resolução de problemas reais, projetos aplicados e metodologias ativas. Para monitoramento contínuo, a escala de Likert pode ser útil pela simplicidade e fácil manipulação dos resultados, e para diagnósticos mais finos de opiniões, a escala de Thurstone se mostra mais eficaz. 

Em suma, os resultados reforçam a centralidade do conhecimento prático na formação em nível superior e indicam que as escalas de Likert e Thurstone são instrumentos válidos que podem ser complementares em análises, **a combinação dessas escalas em processos de questionários podem melhorar a precisão dos resultados**, garantindo melhor coesão e afirmações estatísticas em contextos reais. 


## **ANEXO**

```
# Pacotes necessarios
req <- c("here","readr","dplyr","ggplot2","tidyr","psych","gridExtra","stringr")
inst <- req[!req %in% installed.packages()[,1]]
if(length(inst)) install.packages(inst)
lapply(req, library, character.only = TRUE)

# Arquivos
dados_respostas <- read_csv(here("dados", "Opiniao dos estudantes (Responses).csv"))
dados_pesos <- read_csv(here("dados", "Peso das perguntas pesquisa.csv"))


# Exibe respostas obtidas
table(dados_respostas$`Qual a sua situação atual em relação ao ensino superior?`)
cat("Dim respostas (Pessoas/questoes):", dim(dados_respostas), "\n")

# Filtrar para manter apenas quem está cursando ou já concluiu
dados_respostas_filtrados <- dados_respostas %>%
  filter(`Qual a sua situação atual em relação ao ensino superior?` %in% 
           c("Estou cursando uma graduação/pós-graduação", 
             "Já concluí uma graduação/pós-graduação"))
# Exibe respostas filtradas
table(dados_respostas_filtrados$`Qual a sua situação atual em relação ao ensino superior?`)
cat("Respostas após filtro (Pessoas/questoes):", dim(dados_respostas_filtrados), "\n")


cat("Colunas respostas:\n"); print(names(dados_respostas_filtrados))
#cat("Dim pesos:", dim(dados_pesos), "\n")
#cat("Colunas pesos:\n"); print(names(dados_pesos))

# Seleção das colunas (F:J Likert = 6:10; K:O Thurstone = 11:15)
stopifnot(ncol(dados_respostas_filtrados) >= 15)
colunas_likert    <- dados_respostas_filtrados[, 6:10]
colunas_thurstone <- dados_respostas_filtrados[, 11:15]
names(colunas_likert)    <- paste0("Likert_", 1:5)
names(colunas_thurstone) <- paste0("Thurstone_", 1:5)

# Remover linhas totalmente vazias nas áreas F:O (comuns em CSV exportado)
zona_itens <- dados_respostas_filtrados[, 6:15]
linhas_validas <- apply(zona_itens, 1, function(r) any(!(is.na(r) | r == "")))
dados_respostas_filtrados <- dados_respostas_filtrados[linhas_validas, ]
colunas_likert    <- dados_respostas_filtrados[, 6:10]
colunas_thurstone <- dados_respostas_filtrados[, 11:15]
names(colunas_likert)    <- paste0("Likert_", 1:5)
names(colunas_thurstone) <- paste0("Thurstone_", 1:5)

# Conversão: Likert para numérico (robusto)
to_num_likert <- function(x) {
  x_chr <- trimws(tolower(as.character(x)))
  # tenta conversão direta (ex.: "1","2")
  out <- suppressWarnings(as.numeric(x_chr))
  # se maioria virou NA, mapear textos
  if(mean(is.na(out)) > 0.5) {
    out <- dplyr::case_when(
      x_chr %in% c("1","discordo totalmente") ~ 1,
      x_chr %in% c("2","discordo parcialmente") ~ 2,
      x_chr %in% c("3","não concordo nem discordo") ~ 3,
      x_chr %in% c("4","concordo parcialmente") ~ 4,
      x_chr %in% c("5","concordo totalmente") ~ 5,
      str_detect(x_chr, "^1") ~ 1,
      str_detect(x_chr, "^2") ~ 2,
      str_detect(x_chr, "^3") ~ 3,
      str_detect(x_chr, "^4") ~ 4,
      str_detect(x_chr, "^5") ~ 5,
      TRUE ~ NA_real_
    )
  }
  out
}
colunas_likert_num <- as.data.frame(lapply(colunas_likert, to_num_likert))
names(colunas_likert_num) <- names(colunas_likert)

# Invertendo os itens 4 e 5 para valorização da prática (Perguntas pró-teoria para seguir mesma direção)
itens_invertidos <- c("Likert_4", "Likert_5") 
if(length(itens_invertidos)) {
  colunas_likert_num[itens_invertidos] <- lapply(colunas_likert_num[itens_invertidos], function(x) 6 - x)
}

# Escore Likert
dados_respostas_filtrados$escore_likert <- rowSums(colunas_likert_num, na.rm = TRUE)

# itens_com_var <- colunas_likert_num[, sapply(colunas_likert_num, function(v) var(v, na.rm = TRUE) > 0), drop = FALSE]
# if(ncol(itens_com_var) >= 2) {
#   alpha_likert <- psych::alpha(itens_com_var, warnings = FALSE)
#   cat("Alfa de Cronbach (Likert):", round(alpha_likert$total$raw_alpha, 3), "\n")
# } else {
#   alpha_likert <- NULL
#   cat("Sem variabilidade suficiente nos itens Likert para calcular alfa.\n")
# }

# Estatísticas Likert
likert_stats <- data.frame(
  Estatistica = c("Média","Mediana","Desvio Padrão","IQR","Min","Max"),
  Valor = c(
    mean(dados_respostas_filtrados$escore_likert, na.rm = TRUE),
    median(dados_respostas_filtrados$escore_likert, na.rm = TRUE),
    sd(dados_respostas_filtrados$escore_likert, na.rm = TRUE),
    IQR(dados_respostas_filtrados$escore_likert, na.rm = TRUE),
    min(dados_respostas_filtrados$escore_likert, na.rm = TRUE),
    max(dados_respostas_filtrados$escore_likert, na.rm = TRUE)
  )
)

# -------------------------------------------------------------------------------------------------
# 8) Thurstone: binariza pesos (0 discordo e 1 concordo)
to_bin_thurstone <- function(x){
  x_chr <- trimws(tolower(as.character(x)))
  dplyr::case_when(
    x_chr == "concordo"  ~ 1,
    x_chr == "discordo" ~ 0,
    TRUE ~ NA_real_
  )
}
colunas_thurstone_bin <- as.data.frame(lapply(colunas_thurstone, to_bin_thurstone))
names(colunas_thurstone_bin) <- names(colunas_thurstone)

# Acessa os pesos e converte para numero
pesos_thurstone <- as.numeric(dados_pesos$`Mediana (peso final)`)
pesos_thurstone <- pesos_thurstone[1:5] 

# escore Thurstone = média dos pesos das afirmativas com concordo (1)
mat_bin <- as.matrix(colunas_thurstone_bin)
soma_pesos <- mat_bin %*% matrix(pesos_thurstone, ncol = 1)
qtd_conc   <- rowSums(colunas_thurstone_bin, na.rm = TRUE)

# Calcula escore thurstone e coloca na tabela respostasfiltradas (11-Valoriza teoria e 1-Valoriza pratica)
dados_respostas_filtrados$escore_thurstone <- ifelse(qtd_conc > 0, soma_pesos[,1] / qtd_conc, NA_real_)

# Estatísticas Thurstone
thurstone_stats <- data.frame(
  Estatistica = c("Média","Mediana","Desvio Padrão","IQR","Min","Max"),
  Valor = c(
    mean(dados_respostas_filtrados$escore_thurstone, na.rm = TRUE),
    median(dados_respostas_filtrados$escore_thurstone, na.rm = TRUE),
    sd(dados_respostas_filtrados$escore_thurstone, na.rm = TRUE),
    IQR(dados_respostas_filtrados$escore_thurstone, na.rm = TRUE),
    min(dados_respostas_filtrados$escore_thurstone, na.rm = TRUE),
    max(dados_respostas_filtrados$escore_thurstone, na.rm = TRUE)
  )
)

cat("\nResumo Likert:\n"); print(likert_stats)
cat("\nResumo Thurstone:\n"); print(thurstone_stats)

# Gráficos
dir.create("plots", showWarnings = FALSE)

# Distribuicao likert
g_hist_likert <- ggplot(dados_respostas_filtrados, aes(x = escore_likert)) +
  geom_histogram(bins = 10, fill = "skyblue", color = "black", alpha = 0.8) +
  labs(title = "Distribuição de Escores - Likert", x = "Escore total", y = "Frequência") +
  theme_minimal() +
  scale_x_continuous(breaks = seq(0, 25, by = 1)) +
  scale_y_continuous(breaks = seq(0, 15, by = 1))

# Boxplot likert exibe mediana, valores extremos (max 25 (pratica), min 5(teoria))
g_box_likert <- ggplot(dados_respostas_filtrados, aes(y = escore_likert)) +
  geom_boxplot(fill = "skyblue") +
  labs(title = "Boxplot - Likert", y = "Escore total") +
  theme_minimal() +
  scale_y_continuous(breaks = seq(10, 25, by = 2))

# Distribuicao thurstone 
g_hist_thurst <- ggplot(dados_respostas_filtrados, aes(x = escore_thurstone)) +
  geom_histogram(bins = 10, fill = "lightgreen", color = "black", alpha = 0.8) +
  labs(title = "Distribuição de Escores - Thurstone", x = "Escore", y = "Frequência") +
  theme_minimal() +
  scale_x_continuous(breaks = seq(2, 10, by = 1)) +
  scale_y_continuous(breaks = seq(0, 15, by = 1))

# Boxplot Thurstone (max 10 (teoria), min 2(pratica))
g_box_thurst <- ggplot(dados_respostas_filtrados, aes(y = escore_thurstone)) +
  geom_boxplot(fill = "lightgreen") +
  labs(title = "Boxplot - Thurstone", y = "Escore") +
  theme_minimal() +
  scale_y_continuous(breaks = seq(2, 10, by = 1))


# Comparação e correlação
dados_comp <- dados_respostas_filtrados %>%
  select(escore_likert, escore_thurstone) %>%
  pivot_longer(cols = everything(), names_to = "Escala", values_to = "Escore")

# Boxplot comparativo entre likert e thurstone
g_box_comp <- ggplot(dados_comp, aes(x = Escala, y = Escore, fill = Escala)) +
  geom_boxplot() +
  scale_fill_manual(values = c("escore_likert" = "skyblue", "escore_thurstone" = "lightgreen")) +
  labs(title = "Comparação de Escores", x = "", y = "Escore") +
  theme_minimal() +
  scale_y_continuous(breaks = seq(0, 25, by = 5))
  
# Histogramas entre Escores para comparar distribuições
g_hist_facet <- ggplot(dados_comp, aes(x = Escore, fill = Escala)) +
  geom_histogram(bins = 10, color = "black", alpha = 0.6) +
  facet_wrap(~Escala, scales = "free") +
  scale_fill_manual(values = c("escore_likert" = "skyblue", "escore_thurstone" = "lightgreen")) +
  labs(title = "Distribuição de Escores", x = "Escore", y = "Frequência") +
  theme_minimal() +
  scale_y_continuous(breaks = seq(0, 15, by = 2))


# Salva gráficos
ggsave("plots/distribuicao_likert.png", g_hist_likert, width = 6, height = 4, dpi = 150)
ggsave("plots/box_likert.png", g_box_likert, width = 4, height = 4, dpi = 150)
ggsave("plots/distribuicao_thurstone.png", g_hist_thurst, width = 6, height = 4, dpi = 150)
ggsave("plots/box_thurstone.png", g_box_thurst, width = 4, height = 4, dpi = 150)
ggsave("plots/box_comparativo.png", g_box_comp, width = 5, height = 4, dpi = 150)
ggsave("plots/histogramas_facetados.png", g_hist_facet, width = 6, height = 4, dpi = 150)

# Exportar escores finais para uso no R Markdown
saida <- dados_respostas_filtrados %>%
  mutate(across(everything(), as.character)) %>%
  bind_cols(
    colunas_likert_num %>% mutate(across(everything(), as.character)),
    colunas_thurstone %>% mutate(across(everything(), as.character))
  ) %>%
  select(escore_likert, escore_thurstone, everything())

write_csv(saida, "escores_finais.csv")
cat("\nArquivo 'escores_finais.csv' salvo e gráficos na pasta 'plots/'.\n")
```